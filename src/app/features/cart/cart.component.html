
<div class="cart-container" dir="rtl">
  <!-- Step 1: Cart View -->
  <div *ngIf="step === 1" class="cart-step">
    <div class="row">
      <!-- Cart Items: 64% width, aligned to the left -->
      <div class="cart-items-wrapper">
        <h2 class="cart-title">ุณูุฉ ุงูุชุณูู</h2>
        <button *ngIf="step === 1" class="action-button navigate-button" (click)="scrollToOrderSummary()" aria-label="ุงูุฐูุงุจ ูุชุฃููุฏ ุงูุทูุจ">
          ุงูุฐูุงุจ ูุชุฃููุฏ ุงูุทูุจ
        </button>
        <div class="cart-items">
          <div *ngFor="let item of cartItems" class="book-card">
            <div class="book-rating">
              <span class="star" *ngFor="let _ of [].constructor(item.rating)">โญ</span>
            </div>
            <div class="book-card-slideshow">
              <div class="book-slide active" [style.backgroundImage]="'url(' + item.image + ')'"></div>
            </div>
            <div class="book-content">
              <div class="book-category-badge">๐ณ {{item.category}}</div>
              <h2 class="book-title">{{item.title}}</h2>
              <p class="book-description">{{item.description}}</p>
              <div class="book-price-container">
                <span class="book-price">{{item.price * item.quantity | number:'1.2-2'}} ุฌ.ู</span>
                <span class="price-badge">ุนุฑุถ ุฎุงุต</span>
              </div>
              <div class="book-actions">
                <div class="quantity-control">
                  <button class="quantity-button" (click)="updateQuantity(item, -1)" aria-label="ุชูููู ุงููููุฉ">-</button>
                  <span class="quantity">{{item.quantity}}</span>
                  <button class="quantity-button" (click)="updateQuantity(item, 1)" aria-label="ุฒูุงุฏุฉ ุงููููุฉ">+</button>
                </div>
                <button class="action-button remove-button" (click)="removeFromCart(item.id)" aria-label="ุฅุฒุงูุฉ ูู ุงูุณูุฉ">
                  <i class="fas fa-trash"></i>
                  <span class="button-tooltip">ุฅุฒุงูุฉ</span>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- Order Summary: fixed to the right -->
      <div class="order-summary-wrapper" id="order-summary">
        <div class="order-summary">
          <h3 class="summary-title">ููุฎุต ุงูุทูุจ</h3>
          <div class="summary-content">
            <div class="coupon-section">
              <input type="text" [(ngModel)]="couponCode" placeholder="ููุจูู ุงูุฎุตู" class="coupon-input" aria-label="ุฅุฏุฎุงู ููุจูู ุงูุฎุตู">
              <button class="action-button apply-coupon" (click)="applyCoupon()">ุชุฃููุฏ</button>
            </div>
            <div class="summary-details">
              <div class="summary-row">
                <span>ุงููุจูุบ</span>
                <span>{{getSubtotal() | number:'1.2-2'}} ุฌ.ู</span>
              </div>
              <div class="summary-row" *ngIf="discount > 0">
                <span>ุงูุฎุตู</span>
                <span>-{{discount | number:'1.2-2'}} ุฌ.ู</span>
              </div>
              <div class="summary-row total">
                <span>ุงููุจูุบ ุงูููู</span>
                <span>{{getTotalPrice() | number:'1.2-2'}} ุฌ.ู</span>
              </div>
            </div>
            <button class="action-button proceed-button" (click)="nextStep()" [disabled]="cartItems.length === 0" aria-label="ุชุฃููุฏ ุงูุทูุจ">
              ุชุฃููุฏ ุงูุทูุจ
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Step 2: Shipping and Order Confirmation -->
  <div *ngIf="step === 2" class="cart-step">
    <div class="row">
      <!-- Cart Items: 64% width, aligned to the left -->
      <div class="cart-items-wrapper">
        <h2 class="cart-title">ุนูุงุตุฑ ุงูุณูุฉ</h2>
        <div class="cart-items">
          <div *ngFor="let item of cartItems" class="book-card">
            <div class="book-rating">
              <span class="star" *ngFor="let _ of [].constructor(item.rating)">โญ</span>
            </div>
            <div class="book-card-slideshow">
              <div class="book-slide active" [style.backgroundImage]="'url(' + item.image + ')'"></div>
            </div>
            <div class="book-content">
              <div class="book-category-badge">๐ณ {{item.category}}</div>
              <h2 class="book-title">{{item.title}}</h2>
              <p class="book-description">{{item.description}}</p>
              <div class="book-price-container">
                <span class="book-price">{{item.price * item.quantity | number:'1.2-2'}} ุฌ.ู</span>
                <span class="price-badge">ุนุฑุถ ุฎุงุต</span>
              </div>
              <div class="book-actions">
                <div class="quantity-control">
                  <button class="quantity-button" (click)="updateQuantity(item, -1)" aria-label="ุชูููู ุงููููุฉ">-</button>
                  <span class="quantity">{{item.quantity}}</span>
                  <button class="quantity-button" (click)="updateQuantity(item, 1)" aria-label="ุฒูุงุฏุฉ ุงููููุฉ">+</button>
                </div>
                <button class="action-button remove-button" (click)="removeFromCart(item.id)" aria-label="ุฅุฒุงูุฉ ูู ุงูุณูุฉ">
                  <i class="fas fa-trash"></i>
                  <span class="button-tooltip">ุฅุฒุงูุฉ</span>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- Shipping Form and Order Details: fixed to the right -->
      <div class="order-summary-wrapper" id="order-summary">
        <div class="order-summary">
          <h3 class="summary-title">ุชูุงุตูู ุงูุทูุจ</h3>
          <div class="summary-content">
            <form class="shipping-form">
              <select [(ngModel)]="shippingInfo.governorate" name="governorate" required aria-label="ุงุฎุชูุงุฑ ุงููุญุงูุธุฉ">
                <option value="" disabled selected>ุงุฎุชุฑ ุงููุญุงูุธุฉ</option>
                <option *ngFor="let governorate of governorates" [value]="governorate">{{governorate}}</option>
              </select>
              <input type="text" [(ngModel)]="shippingInfo.name" name="name" placeholder="ุงูุงุณู ุงููุงูู" required aria-label="ุงูุงุณู ุงููุงูู">
              <input type="text" [(ngModel)]="shippingInfo.address" name="address" placeholder="ุงูุนููุงู" required aria-label="ุงูุนููุงู">
              <textarea [(ngModel)]="shippingInfo.notes" name="notes" placeholder="ุงูููุงุญุธุงุช (ุงุฎุชูุงุฑู)" aria-label="ุงูููุงุญุธุงุช"></textarea>
              <div class="payment-method">
                <label>ุทุฑููุฉ ุงูุฏูุน</label>
                <div class="payment-option">ูุงุด ุนูุฏ ุงูุงุณุชูุงู</div>
              </div>
              <div class="order-details-summary">
                <h4>ููุฎุต ุงูุชูุงุตูู</h4>
                <p *ngIf="shippingInfo.governorate"><strong>ุงููุญุงูุธุฉ:</strong> {{shippingInfo.governorate}}</p>
                <p *ngIf="shippingInfo.name"><strong>ุงูุงุณู:</strong> {{shippingInfo.name}}</p>
                <p *ngIf="shippingInfo.address"><strong>ุงูุนููุงู:</strong> {{shippingInfo.address}}</p>
                <p *ngIf="shippingInfo.notes"><strong>ุงูููุงุญุธุงุช:</strong> {{shippingInfo.notes}}</p>
                <p><strong>ุทุฑููุฉ ุงูุฏูุน:</strong> ูุงุด ุนูุฏ ุงูุงุณุชูุงู</p>
                <p><strong>ุงููุจูุบ ุงูููู:</strong> {{getTotalPrice() | number:'1.2-2'}} ุฌ.ู</p>
              </div>
              <div class="form-actions">
                <button type="button" class="action-button" (click)="prevStep()" aria-label="ุฑุฌูุน">ุฑุฌูุน</button>
                <button type="button" class="action-button" (click)="submitShipping()" [disabled]="!shippingInfo.governorate || !shippingInfo.name || !shippingInfo.address" aria-label="ุชุฃููุฏ ุงูุทูุจ">ุชุฃููุฏ ุงูุทูุจ</button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
